schema: '2.0'
stages:
  setup:
    cmd: bash run.sh python -m attention
    deps:
    - path: attention.py
      hash: md5
      md5: 3fa28553a44bca5080eb1c1404059d73
      size: 12910
    - path: noctua.sh
      hash: md5
      md5: f3e8cc342b63cddcd2e07bfe63f6518c
      size: 1832
    - path: run.sh
      hash: md5
      md5: 6e3e34149c16795c5a8424a51bdbf5f8
      size: 1616
    params:
      params.yaml:
        model:
          num_heads: 1
          num_layers: 1
          bias: true
          emb_dim: 8
          mlp_dim: 32
          seq_len: 32
          bits: 4
          mask: none
    outs:
    - path: attention.onnx
      hash: md5
      md5: 1d8a4806e60b720be6a108eb0ff7f1f9
      size: 27193
    - path: inp.npy
      hash: md5
      md5: 5c2ea3078dd7b58d85d9ab424c1243cc
      size: 1152
    - path: out.npy
      hash: md5
      md5: 77d13e8be8cda33479fad2acb7dc6c6f
      size: 1152
  build:
    cmd: bash run.sh '$FINN/run-docker.sh build_custom $(pwd)'
    deps:
    - path: attention.onnx
      hash: md5
      md5: 1d8a4806e60b720be6a108eb0ff7f1f9
      size: 27193
    - path: build.py
      hash: md5
      md5: 025cf185c244d63570c4a9e123241ab1
      size: 5779
    - path: build_steps.py
      hash: md5
      md5: 1aff560b46b8185da6aa440bf4d5c569
      size: 12076
    - path: inp.npy
      hash: md5
      md5: 5c2ea3078dd7b58d85d9ab424c1243cc
      size: 1152
    - path: noctua.sh
      hash: md5
      md5: f3e8cc342b63cddcd2e07bfe63f6518c
      size: 1832
    - path: out.npy
      hash: md5
      md5: 77d13e8be8cda33479fad2acb7dc6c6f
      size: 1152
    - path: run.sh
      hash: md5
      md5: 6e3e34149c16795c5a8424a51bdbf5f8
      size: 1616
    - path: transformation/
      hash: md5
      md5: 442571afa6ba9d6d6b1cfcd26f02d34a.dir
      size: 104396
      nfiles: 8
    params:
      params.yaml:
        build:
          output_dir: build
          synth_clk_period_ns: 10.0
          board: RFSoC2x2
          folding_config_file: folding.json
      folding.json:
        AddStreams_Batch_0:
          inFIFODepths:
          - 256
          - 256
          PE: 1
        AddStreams_Batch_1:
          inFIFODepths:
          - 256
          - 256
          PE: 1
        Defaults:
          inFIFODepths:
          - - 2
            - 2
            - 2
            - 2
          - all
          outFIFODepths:
          - - 2
            - 2
            - 2
            - 2
          - all
          SIMD:
          - 2
          - - MatrixVectorActivation
          PE:
          - 4
          - - MatrixVectorActivation
          ram_style:
          - block
          - - StreamingFIFO
            - MatrixVectorActivation
        ScaledDotProductAttention_0:
          inFIFODepths:
          - 256
          - 256
          - 256
          SeqFold: 32
          EmbFold: 1
        Thresholding_Batch_0:
          PE: 1
        Thresholding_Batch_1:
          PE: 1
        Thresholding_Batch_2:
          PE: 1
        Thresholding_Batch_3:
          PE: 1
        Thresholding_Batch_4:
          PE: 1
    outs:
    - path: build/
      hash: md5
      md5: 4b8cafcde60149aa59d7fc17d8910a84.dir
      size: 86571108
      nfiles: 814
  metrics:
    cmd: python -m metrics
    deps:
    - path: build/
      hash: md5
      md5: 4b8cafcde60149aa59d7fc17d8910a84.dir
      size: 86571108
      nfiles: 814
    - path: build/report/post_synth_resources.json
      hash: md5
      md5: 638233abfad8d395e5439c7d8bc75ecc
      size: 6712
    - path: metrics.py
      hash: md5
      md5: 027dcb70a77c34f84948bc3d5ee2107f
      size: 932
    - path: noctua.sh
      hash: md5
      md5: f3e8cc342b63cddcd2e07bfe63f6518c
      size: 1832
    - path: run.sh
      hash: md5
      md5: 6e3e34149c16795c5a8424a51bdbf5f8
      size: 1616
    params:
      params.yaml:
        build.output_dir: build
        metrics:
          report: build/report/post_synth_resources.json
          filter: (top)
    outs:
    - path: metrics.yaml
      hash: md5
      md5: acd3a4e31c4eaa26ee3bcc3af031f876
      size: 71
  folding:
    cmd: python -m make_folding
    deps:
    - path: make_folding.py
      hash: md5
      md5: d333be249c3cd087cd2b80441665c507
      size: 7588
    - path: noctua.sh
      hash: md5
      md5: f3e8cc342b63cddcd2e07bfe63f6518c
      size: 1832
    - path: run.sh
      hash: md5
      md5: 6e3e34149c16795c5a8424a51bdbf5f8
      size: 1616
    params:
      params.yaml:
        build:
          output_dir: build
          synth_clk_period_ns: 10.0
          board: RFSoC2x2
          folding_config_file: folding.json
        model:
          num_heads: 1
          num_layers: 1
          bias: true
          emb_dim: 8
          mlp_dim: 32
          seq_len: 32
          bits: 4
          mask: none
    outs:
    - path: folding.json
      hash: md5
      md5: 180027142b9f0317408eec3b1594a572
      size: 634
