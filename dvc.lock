schema: '2.0'
stages:
  setup:
    cmd: python -m attention
    deps:
    - path: attention.py
      hash: md5
      md5: 3fa28553a44bca5080eb1c1404059d73
      size: 12910
    params:
      params.yaml:
        model:
          num_heads: 1
          num_layers: 1
          bias: true
          emb_dim: 8
          mlp_dim: 32
          seq_len: 32
          bits: 4
          mask: none
    outs:
    - path: attention.onnx
      hash: md5
      md5: 3faae6c41bdccb73a5efbb03fd8d8830
      size: 27193
    - path: inp.npy
      hash: md5
      md5: 2cadcbbc9641db1a0eff27bce5d85015
      size: 1152
    - path: out.npy
      hash: md5
      md5: 3229f942c61626d1dbdae846bd260b21
      size: 1152
  build:
    cmd: bash run.sh '$FINN/run-docker.sh build_custom $(pwd)'
    deps:
    - path: attention.onnx
      hash: md5
      md5: 3faae6c41bdccb73a5efbb03fd8d8830
      size: 27193
    - path: build.py
      hash: md5
      md5: 6e11e7eec6dac707b1c29d45ddad5a84
      size: 5793
    - path: build_steps.py
      hash: md5
      md5: e2b3f904510d73d5996d5d9aec135c6a
      size: 13083
    - path: inp.npy
      hash: md5
      md5: 2cadcbbc9641db1a0eff27bce5d85015
      size: 1152
    - path: noctua.sh
      hash: md5
      md5: f3e8cc342b63cddcd2e07bfe63f6518c
      size: 1832
    - path: out.npy
      hash: md5
      md5: 3229f942c61626d1dbdae846bd260b21
      size: 1152
    - path: run.sh
      hash: md5
      md5: 6e3e34149c16795c5a8424a51bdbf5f8
      size: 1616
    - path: transformation/
      hash: md5
      md5: 442571afa6ba9d6d6b1cfcd26f02d34a.dir
      size: 104396
      nfiles: 8
    params:
      params.yaml:
        build:
          output_dir: build
          synth_clk_period_ns: 10.0
          board: RFSoC2x2
          shell_flow_type: vivado_zynq
          folding_config_file: folding.json
          specialize_layers_config_file: specialize_layers.json
          standalone_thresholds: true
      folding.json:
        AddStreams_hls_0:
          inFIFODepths:
          - 1024
          - 1024
          PE: 1
        AddStreams_hls_1:
          inFIFODepths:
          - 1024
          - 1024
          PE: 1
        Defaults:
          inFIFODepths:
          - - 2
            - 2
            - 2
            - 2
          - all
          outFIFODepths:
          - - 2
            - 2
            - 2
            - 2
          - all
          SIMD:
          - 2
          - - MVAU_hls
            - MVAU_rtl
          PE:
          - 4
          - - MVAU_hls
            - MVAU_rtl
          ram_style:
          - auto
          - - StreamingFIFO_hls
            - StreamingFIFO_rtl
            - MVAU_hls
            - MVAU_rtl
        ScaledDotProductAttention_hls_0:
          inFIFODepths:
          - 32
          - 32
          - 32
          SeqFold: 32
          EmbFold: 1
        Thresholding_rtl_0:
          PE: 1
        Thresholding_rtl_1:
          PE: 1
        Thresholding_rtl_2:
          PE: 1
        Thresholding_rtl_3:
          PE: 1
        Thresholding_rtl_4:
          PE: 1
        Thresholding_rtl_5:
          PE: 1
        Thresholding_rtl_6:
          PE: 1
        Thresholding_rtl_7:
          PE: 1
        Thresholding_rtl_8:
          PE: 1
    outs:
    - path: build/
      hash: md5
      md5: 5c61ad912e76cab3b08315359ba9f08a.dir
      size: 93148038
      nfiles: 989
  metrics:
    cmd: python -m metrics
    deps:
    - path: build/
      hash: md5
      md5: 5c61ad912e76cab3b08315359ba9f08a.dir
      size: 93148038
      nfiles: 989
    - path: build/report/post_synth_resources.json
      hash: md5
      md5: 7434fd4d3735f1e0fa2c887ac3db9585
      size: 14188
    - path: metrics.py
      hash: md5
      md5: 027dcb70a77c34f84948bc3d5ee2107f
      size: 932
    params:
      params.yaml:
        build.output_dir: build
        metrics:
          report: build/report/post_synth_resources.json
          filter: (top)
    outs:
    - path: metrics.yaml
      hash: md5
      md5: 0d783eae64baee9919324428d9463a4c
      size: 71
  folding:
    cmd: python -m make_folding
    deps:
    - path: make_folding.py
      hash: md5
      md5: 7139b86d69d13939760fe7e4005c964b
      size: 7511
    params:
      params.yaml:
        build:
          output_dir: build
          synth_clk_period_ns: 10.0
          board: RFSoC2x2
          shell_flow_type: vivado_zynq
          folding_config_file: folding.json
          specialize_layers_config_file: specialize_layers.json
          standalone_thresholds: true
        model:
          num_heads: 1
          num_layers: 1
          bias: true
          emb_dim: 8
          mlp_dim: 32
          seq_len: 32
          bits: 4
          mask: none
    outs:
    - path: folding.json
      hash: md5
      md5: f9586c39e33cbafc4a0ed4ce47e39d02
      size: 775
