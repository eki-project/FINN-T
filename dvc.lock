schema: '2.0'
stages:
  setup:
    cmd: python -m export
    deps:
    - path: export.py
      hash: md5
      md5: 22b083825291395d2964e9b92e08536b
      size: 3846
    - path: model.py
      hash: md5
      md5: 2611ba6af6785ff4dd11b543bee094d7
      size: 25202
    params:
      params.yaml:
        export:
          opset_version: 14
          do_constant_folding: true
        model:
          num_heads: 1
          num_layers: 1
          bias: true
          emb_dim: 8
          mlp_dim: 32
          seq_len: 32
          bits: 4
          norm: none
          mask: none
          positional_encoding: binary
        seed: 12
    outs:
    - path: attention.onnx
      hash: md5
      md5: bc89ae55a2c874cc917ac198973bbc6a
      size: 38801
    - path: inp.npy
      hash: md5
      md5: 9b75b0cd1d4fc3b0f4af8401da83b7f4
      size: 1152
    - path: out.npy
      hash: md5
      md5: a446bf5b03628946ffa374edbed4400b
      size: 1152
  build:
    cmd: bash run.sh '$FINN/run-docker.sh build_custom $(pwd)'
    deps:
    - path: attention.onnx
      hash: md5
      md5: bc89ae55a2c874cc917ac198973bbc6a
      size: 38801
    - path: build.py
      hash: md5
      md5: 76386c4596e5ba0c7804004892b59151
      size: 6277
    - path: build_steps.py
      hash: md5
      md5: 303b3feea23dcc257a008aa819265158
      size: 15206
    - path: inp.npy
      hash: md5
      md5: 9b75b0cd1d4fc3b0f4af8401da83b7f4
      size: 1152
    - path: noctua.sh
      hash: md5
      md5: f3e8cc342b63cddcd2e07bfe63f6518c
      size: 1832
    - path: out.npy
      hash: md5
      md5: a446bf5b03628946ffa374edbed4400b
      size: 1152
    - path: run.sh
      hash: md5
      md5: 6e3e34149c16795c5a8424a51bdbf5f8
      size: 1616
    params:
      params.yaml:
        build:
          output_dir: build
          stitched_ip_gen_dcp: false
          synth_clk_period_ns: 10.0
          board: RFSoC2x2
          shell_flow_type: vivado_zynq
          folding_config_file: folding.json
          specialize_layers_config_file: specialize_layers.json
          standalone_thresholds: true
        model.emb_dim: 8
        model.seq_len: 32
        seed: 12
      folding.json:
        Defaults:
          inFIFODepths:
          - - 2
            - 2
            - 2
            - 2
          - all
          outFIFODepths:
          - - 2
            - 2
            - 2
            - 2
          - all
          ram_style:
          - auto
          - - StreamingFIFO_hls
            - StreamingFIFO_rtl
            - MVAU_hls
            - MVAU_rtl
        ElementwiseAdd_hls_0:
          inFIFODepths:
          - 2
          - 2
        ElementwiseAdd_hls_1:
          inFIFODepths:
          - 1024
          - 1024
        ElementwiseAdd_hls_2:
          inFIFODepths:
          - 1024
          - 1024
        ScaledDotProductAttention_hls_0:
          inFIFODepths:
          - 32
          - 32
          - 32
      specialize_layers.json:
        '':
          preferred_impl_style: ''
        Defaults:
          preferred_impl_style:
          - rtl
          - - MVAU
            - Thresholding
    outs:
    - path: build/
      hash: md5
      md5: 7bf662650f572ff27748e477f9e77ab1.dir
      size: 92049175
      nfiles: 911
  metrics:
    cmd: python -m metrics
    deps:
    - path: build/
      hash: md5
      md5: 7bf662650f572ff27748e477f9e77ab1.dir
      size: 92049175
      nfiles: 911
    - path: build/report/post_synth_resources.json
      hash: md5
      md5: d0e16c37e4a7188b25ea758a112bfe07
      size: 12321
    - path: metrics.py
      hash: md5
      md5: 027dcb70a77c34f84948bc3d5ee2107f
      size: 932
    params:
      params.yaml:
        build.output_dir: build
        metrics:
          report: build/report/post_synth_resources.json
          filter: (top)
    outs:
    - path: metrics.yaml
      hash: md5
      md5: b775a7820d7890676254e2e9cd1e4f14
      size: 71
  folding:
    cmd: python -m make_folding
    deps:
    - path: make_folding.py
      hash: md5
      md5: 6577bd4a83b4d51038ef68ebed9cb4b5
      size: 3467
    params:
      params.yaml:
        build:
          output_dir: build
          stitched_ip_gen_dcp: false
          synth_clk_period_ns: 10.0
          board: RFSoC2x2
          shell_flow_type: vivado_zynq
          folding_config_file: folding.json
          specialize_layers_config_file: specialize_layers.json
          standalone_thresholds: true
        model:
          num_heads: 1
          num_layers: 1
          bias: true
          emb_dim: 8
          mlp_dim: 32
          seq_len: 32
          bits: 4
          norm: none
          mask: none
          positional_encoding: binary
    outs:
    - path: folding.json
      hash: md5
      md5: 991c1938a9c9ade92df1748b2947e185
      size: 413
